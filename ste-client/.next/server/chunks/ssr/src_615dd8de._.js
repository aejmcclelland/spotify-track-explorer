module.exports=[19032,a=>{"use strict";a.s(["delJson",()=>e,"getJson",()=>d,"postJson",()=>c]);let b=process.env.NEXT_PUBLIC_API_BASE??"http://localhost:8080";async function c(a,c){let d={"Content-Type":"application/json"};console.debug("API fetch",a,{hasAuth:!!d.Authorization});let e=await fetch(`${b}${a}`,{method:"POST",headers:d,body:JSON.stringify(c)});if(!e.ok)throw Error(await e.text()||`HTTP ${e.status}`);return e.json()}async function d(a){let c={};console.debug("API fetch",a,{hasAuth:!!c.Authorization});let d=await fetch(`${b}${a}`,{headers:c,cache:"no-store"});if(!d.ok)throw Error(await d.text()||`HTTP ${d.status}`);return d.json()}async function e(a){let c={};console.debug("API delete",a,{hasAuth:!!c.Authorization});let d=await fetch(`${b}${a}`,{method:"DELETE",headers:c});if(!d.ok)throw Error(await d.text()||`HTTP ${d.status}`)}},76488,a=>{"use strict";a.s(["default",()=>f]);var b=a.i(62255),c=a.i(39059),d=a.i(76606),e=a.i(19032);function f(){let[a,f]=(0,c.useState)(null),[g,h]=(0,c.useState)(null),[i,j]=(0,c.useState)(!1),[k,l]=(0,c.useState)(null),[m,n]=(0,c.useState)(!1);(0,c.useEffect)(()=>{(async()=>{try{let a=await (0,e.getJson)("/api/me");f(a)}catch(a){h(a instanceof Error?a.message:"Not signed in")}})()},[]),(0,c.useEffect)(()=>{a&&(async()=>{try{let a=await (0,e.getJson)("/api/spotify/profile");l(a)}catch{l(null)}})()},[a]);let o=async()=>{j(!0);try{let a=await (0,e.getJson)("/api/spotify/authorize");window.location.href=a.authorize_url}catch(a){h(a instanceof Error?a.message:"Failed to start Spotify Auth")}finally{j(!1)}},p=async()=>{n(!0);try{await (0,e.delJson)("/api/spotify/link"),l(null)}catch(a){h(a instanceof Error?a.message:"Failed to disconnect")}finally{n(!1)}};return g?(0,b.jsx)("div",{className:"alert alert-error",children:g}):a?(0,b.jsxs)("div",{className:"p-4 space-y-4",children:[(0,b.jsx)("h1",{className:"text-2xl font-bold",children:"Account"}),(0,b.jsxs)("div",{children:["Username: ",(0,b.jsx)("b",{children:a.username})]}),(0,b.jsxs)("div",{children:["Roles: ",(0,b.jsx)("b",{children:a.roles.join(", ")})]}),(0,b.jsx)("div",{className:"divider"}),(0,b.jsx)("div",{className:"flex items-center gap-3",children:k?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("span",{className:"badge badge-success",children:["Linked as ",k.display_name??"Spotify user"]}),(0,b.jsx)("button",{className:"btn btn-outline btn-sm",onClick:p,disabled:m,children:m?"Disconnecting…":"Disconnect Spotify"}),(0,b.jsx)(d.default,{className:"btn btn-sm",href:"/spotify",children:"View Spotify playlists"})]}):(0,b.jsx)("button",{className:"btn btn-outline",onClick:o,disabled:i,children:i?"Connecting…":"Connect Spotify"})})]}):(0,b.jsx)("div",{className:"loading loading-spinner"})}}];

//# sourceMappingURL=src_615dd8de._.js.map