{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/andrewmcclelland/Documents/spotify-track-explorer/ste-client/src/lib/api.ts"],"sourcesContent":["const API_BASE = process.env.NEXT_PUBLIC_API_BASE ?? \"http://localhost:8080\";\n\nfunction getToken(): string | null {\n  if (typeof window === \"undefined\") return null;\n  return localStorage.getItem(\"access_token\") ?? localStorage.getItem(\"token\");\n}\n\nexport async function postJson<T>(path: string, body: unknown): Promise<T> {\n  const token = getToken();\n  const headers: Record<string, string> = {\n    \"Content-Type\": \"application/json\",\n  };\n  if (token) {\n    headers[\"Authorization\"] = `Bearer ${token}`;\n  }\n  console.debug(\"API fetch\", path, { hasAuth: !!headers[\"Authorization\"] });\n  const res = await fetch(`${API_BASE}${path}`, {\n    method: \"POST\",\n    headers,\n    body: JSON.stringify(body),\n  });\n  if (!res.ok) {\n    const text = await res.text();\n    throw new Error(text || `HTTP ${res.status}`);\n  }\n  return res.json();\n}\n\nexport async function getJson<T>(path: string): Promise<T> {\n  const token = getToken();\n  const headers: Record<string, string> = {};\n  if (token) {\n    headers[\"Authorization\"] = `Bearer ${token}`;\n  }\n  console.debug(\"API fetch\", path, { hasAuth: !!headers[\"Authorization\"] });\n  const res = await fetch(`${API_BASE}${path}`, {\n    headers,\n    cache: \"no-store\",\n  });\n  if (!res.ok) {\n    const text = await res.text();\n    throw new Error(text || `HTTP ${res.status}`);\n  }\n  return res.json();\n}\n\n// DELETE /api/spotify/profile\nexport async function delJson(path: string): Promise<void> {\n  const token = getToken();\n  const headers: Record<string, string> = {};\n  if (token) {\n    headers[\"Authorization\"] = `Bearer ${token}`;\n  }\n\n  console.debug(\"API delete\", path, { hasAuth: !!headers[\"Authorization\"] });\n\n  const res = await fetch(`${API_BASE}${path}`, {\n    method: \"DELETE\",\n    headers,\n  });\n\n  if (!res.ok) {\n    const text = await res.text();\n    throw new Error(text || `HTTP ${res.status}`);\n  }\n}\n"],"names":[],"mappings":";;;;;;;;AAAA,MAAM,WAAW,QAAQ,GAAG,CAAC,oBAAoB,IAAI;AAErD,SAAS;IACP,wCAAmC,OAAO;;;AAE5C;AAEO,eAAe,SAAY,IAAY,EAAE,IAAa;IAC3D,MAAM,QAAQ;IACd,MAAM,UAAkC;QACtC,gBAAgB;IAClB;IACA,IAAI,OAAO;QACT,OAAO,CAAC,gBAAgB,GAAG,CAAC,OAAO,EAAE,OAAO;IAC9C;IACA,QAAQ,KAAK,CAAC,aAAa,MAAM;QAAE,SAAS,CAAC,CAAC,OAAO,CAAC,gBAAgB;IAAC;IACvE,MAAM,MAAM,MAAM,MAAM,GAAG,WAAW,MAAM,EAAE;QAC5C,QAAQ;QACR;QACA,MAAM,KAAK,SAAS,CAAC;IACvB;IACA,IAAI,CAAC,IAAI,EAAE,EAAE;QACX,MAAM,OAAO,MAAM,IAAI,IAAI;QAC3B,MAAM,IAAI,MAAM,QAAQ,CAAC,KAAK,EAAE,IAAI,MAAM,EAAE;IAC9C;IACA,OAAO,IAAI,IAAI;AACjB;AAEO,eAAe,QAAW,IAAY;IAC3C,MAAM,QAAQ;IACd,MAAM,UAAkC,CAAC;IACzC,IAAI,OAAO;QACT,OAAO,CAAC,gBAAgB,GAAG,CAAC,OAAO,EAAE,OAAO;IAC9C;IACA,QAAQ,KAAK,CAAC,aAAa,MAAM;QAAE,SAAS,CAAC,CAAC,OAAO,CAAC,gBAAgB;IAAC;IACvE,MAAM,MAAM,MAAM,MAAM,GAAG,WAAW,MAAM,EAAE;QAC5C;QACA,OAAO;IACT;IACA,IAAI,CAAC,IAAI,EAAE,EAAE;QACX,MAAM,OAAO,MAAM,IAAI,IAAI;QAC3B,MAAM,IAAI,MAAM,QAAQ,CAAC,KAAK,EAAE,IAAI,MAAM,EAAE;IAC9C;IACA,OAAO,IAAI,IAAI;AACjB;AAGO,eAAe,QAAQ,IAAY;IACxC,MAAM,QAAQ;IACd,MAAM,UAAkC,CAAC;IACzC,IAAI,OAAO;QACT,OAAO,CAAC,gBAAgB,GAAG,CAAC,OAAO,EAAE,OAAO;IAC9C;IAEA,QAAQ,KAAK,CAAC,cAAc,MAAM;QAAE,SAAS,CAAC,CAAC,OAAO,CAAC,gBAAgB;IAAC;IAExE,MAAM,MAAM,MAAM,MAAM,GAAG,WAAW,MAAM,EAAE;QAC5C,QAAQ;QACR;IACF;IAEA,IAAI,CAAC,IAAI,EAAE,EAAE;QACX,MAAM,OAAO,MAAM,IAAI,IAAI;QAC3B,MAAM,IAAI,MAAM,QAAQ,CAAC,KAAK,EAAE,IAAI,MAAM,EAAE;IAC9C;AACF","debugId":null}},
    {"offset": {"line": 81, "column": 0}, "map": {"version":3,"sources":["file:///Users/andrewmcclelland/Documents/spotify-track-explorer/ste-client/src/app/login/page.tsx"],"sourcesContent":["\"use client\";\nimport { useState, useEffect } from \"react\";\nimport { postJson } from \"@/lib/api\";\nimport { useAuth } from \"@/lib/useAuth\";\nimport { useRouter } from \"next/navigation\";\nimport { setToken } from \"@/lib/auth\";\n\nexport default function LoginPage() {\n  const router = useRouter();\n  const { authed } = useAuth();\n  const [username, setUsername] = useState(\"\");\n  const [password, setPassword] = useState(\"\");\n  const [msg, setMsg] = useState<string | null>(null);\n  const [loading, setLoading] = useState(false);\n\n  useEffect(() => {\n    if (authed) router.replace(\"/\");\n  }, [authed, router]);\n\n  async function onSubmit(e: React.FormEvent) {\n    e.preventDefault();\n    setLoading(true);\n    setMsg(null);\n    try {\n      const data = await postJson<{ access_token: string; token_type: string }>(\n        \"/api/auth/token\",\n        { username, password }\n      );\n      setToken(data.access_token);\n      router.replace(\"/\"); // land on Home after login\n    } catch (err: any) {\n      const msg = String(err.message || \"\");\n      setMsg(\n        msg.includes(\"Invalid email or password\")\n          ? \"Invalid email or password\"\n          : msg || \"Login failed\"\n      );\n    } finally {\n      setLoading(false);\n    }\n  }\n\n  return (\n    <div className=\"max-w-md mx-auto\">\n      <h1 className=\"text-2xl font-semibold mb-4\">Sign in</h1>\n      <form className=\"space-y-4\" onSubmit={onSubmit}>\n        <input\n          className=\"input input-bordered w-full\"\n          placeholder=\"email\"\n          type=\"email\"\n          value={username}\n          onChange={(e) => setUsername(e.target.value)}\n          required\n        />\n        <input\n          className=\"input input-bordered w-full\"\n          placeholder=\"password\"\n          type=\"password\"\n          value={password}\n          onChange={(e) => setPassword(e.target.value)}\n          required\n        />\n        <button\n          className={`btn btn-primary w-full ${loading ? \"loading\" : \"\"}`}\n          disabled={loading}\n        >\n          Sign in\n        </button>\n      </form>\n      {msg && <div className=\"alert mt-4\">{msg}</div>}\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;AACA;AACA;AACA;AACA;AACA;AALA;;;;;;;AAOe,SAAS;IACtB,MAAM,SAAS,IAAA,8QAAS;IACxB,MAAM,EAAE,MAAM,EAAE,GAAG,IAAA,gIAAO;IAC1B,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,gVAAQ,EAAC;IACzC,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,gVAAQ,EAAC;IACzC,MAAM,CAAC,KAAK,OAAO,GAAG,IAAA,gVAAQ,EAAgB;IAC9C,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,gVAAQ,EAAC;IAEvC,IAAA,iVAAS,EAAC;QACR,IAAI,QAAQ,OAAO,OAAO,CAAC;IAC7B,GAAG;QAAC;QAAQ;KAAO;IAEnB,eAAe,SAAS,CAAkB;QACxC,EAAE,cAAc;QAChB,WAAW;QACX,OAAO;QACP,IAAI;YACF,MAAM,OAAO,MAAM,IAAA,6HAAQ,EACzB,mBACA;gBAAE;gBAAU;YAAS;YAEvB,IAAA,8HAAQ,EAAC,KAAK,YAAY;YAC1B,OAAO,OAAO,CAAC,MAAM,2BAA2B;QAClD,EAAE,OAAO,KAAU;YACjB,MAAM,MAAM,OAAO,IAAI,OAAO,IAAI;YAClC,OACE,IAAI,QAAQ,CAAC,+BACT,8BACA,OAAO;QAEf,SAAU;YACR,WAAW;QACb;IACF;IAEA,qBACE,6WAAC;QAAI,WAAU;;0BACb,6WAAC;gBAAG,WAAU;0BAA8B;;;;;;0BAC5C,6WAAC;gBAAK,WAAU;gBAAY,UAAU;;kCACpC,6WAAC;wBACC,WAAU;wBACV,aAAY;wBACZ,MAAK;wBACL,OAAO;wBACP,UAAU,CAAC,IAAM,YAAY,EAAE,MAAM,CAAC,KAAK;wBAC3C,QAAQ;;;;;;kCAEV,6WAAC;wBACC,WAAU;wBACV,aAAY;wBACZ,MAAK;wBACL,OAAO;wBACP,UAAU,CAAC,IAAM,YAAY,EAAE,MAAM,CAAC,KAAK;wBAC3C,QAAQ;;;;;;kCAEV,6WAAC;wBACC,WAAW,CAAC,uBAAuB,EAAE,UAAU,YAAY,IAAI;wBAC/D,UAAU;kCACX;;;;;;;;;;;;YAIF,qBAAO,6WAAC;gBAAI,WAAU;0BAAc;;;;;;;;;;;;AAG3C","debugId":null}}]
}