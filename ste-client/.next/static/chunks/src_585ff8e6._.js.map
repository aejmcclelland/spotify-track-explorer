{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/andrewmcclelland/Documents/spotify-track-explorer/ste-client/src/lib/api.ts"],"sourcesContent":["const API_BASE = process.env.NEXT_PUBLIC_API_BASE ?? \"http://localhost:8080\";\n\nfunction getToken(): string | null {\n  if (typeof window === \"undefined\") return null;\n  return localStorage.getItem(\"access_token\") ?? localStorage.getItem(\"token\");\n}\n\nexport async function postJson<T>(path: string, body: unknown): Promise<T> {\n  const token = getToken();\n  const headers: Record<string, string> = { \"Content-Type\": \"application/json\" };\n  if (token) {\n    headers[\"Authorization\"] = `Bearer ${token}`;\n  }\n  console.debug(\"API fetch\", path, { hasAuth: !!headers[\"Authorization\"] });\n  const res = await fetch(`${API_BASE}${path}`, {\n    method: \"POST\",\n    headers,\n    body: JSON.stringify(body),\n  });\n  if (!res.ok) {\n    const text = await res.text();\n    throw new Error(text || `HTTP ${res.status}`);\n  }\n  return res.json();\n}\n\nexport async function getJson<T>(path: string): Promise<T> {\n  const token = getToken();\n  const headers: Record<string, string> = {};\n  if (token) {\n    headers[\"Authorization\"] = `Bearer ${token}`;\n  }\n  console.debug(\"API fetch\", path, { hasAuth: !!headers[\"Authorization\"] });\n  const res = await fetch(`${API_BASE}${path}`, {\n    headers,\n    cache: \"no-store\",\n  });\n  if (!res.ok) {\n    const text = await res.text();\n    throw new Error(text || `HTTP ${res.status}`);\n  }\n  return res.json();\n}\n"],"names":[],"mappings":";;;;;;AAAiB;IAAA;AAAjB,MAAM,WAAW,CAAA,oCAAA,0SAAO,CAAC,GAAG,CAAC,oBAAoB,cAAhC,+CAAA,oCAAoC;AAErD,SAAS;IACP;;QACO;IAAP,OAAO,CAAA,wBAAA,aAAa,OAAO,CAAC,6BAArB,mCAAA,wBAAwC,aAAa,OAAO,CAAC;AACtE;AAEO,eAAe,SAAY,IAAY,EAAE,IAAa;IAC3D,MAAM,QAAQ;IACd,MAAM,UAAkC;QAAE,gBAAgB;IAAmB;IAC7E,IAAI,OAAO;QACT,OAAO,CAAC,gBAAgB,GAAG,AAAC,UAAe,OAAN;IACvC;IACA,QAAQ,KAAK,CAAC,aAAa,MAAM;QAAE,SAAS,CAAC,CAAC,OAAO,CAAC,gBAAgB;IAAC;IACvE,MAAM,MAAM,MAAM,MAAM,AAAC,GAAa,OAAX,UAAgB,OAAL,OAAQ;QAC5C,QAAQ;QACR;QACA,MAAM,KAAK,SAAS,CAAC;IACvB;IACA,IAAI,CAAC,IAAI,EAAE,EAAE;QACX,MAAM,OAAO,MAAM,IAAI,IAAI;QAC3B,MAAM,IAAI,MAAM,QAAQ,AAAC,QAAkB,OAAX,IAAI,MAAM;IAC5C;IACA,OAAO,IAAI,IAAI;AACjB;AAEO,eAAe,QAAW,IAAY;IAC3C,MAAM,QAAQ;IACd,MAAM,UAAkC,CAAC;IACzC,IAAI,OAAO;QACT,OAAO,CAAC,gBAAgB,GAAG,AAAC,UAAe,OAAN;IACvC;IACA,QAAQ,KAAK,CAAC,aAAa,MAAM;QAAE,SAAS,CAAC,CAAC,OAAO,CAAC,gBAAgB;IAAC;IACvE,MAAM,MAAM,MAAM,MAAM,AAAC,GAAa,OAAX,UAAgB,OAAL,OAAQ;QAC5C;QACA,OAAO;IACT;IACA,IAAI,CAAC,IAAI,EAAE,EAAE;QACX,MAAM,OAAO,MAAM,IAAI,IAAI;QAC3B,MAAM,IAAI,MAAM,QAAQ,AAAC,QAAkB,OAAX,IAAI,MAAM;IAC5C;IACA,OAAO,IAAI,IAAI;AACjB","debugId":null}},
    {"offset": {"line": 67, "column": 0}, "map": {"version":3,"sources":["file:///Users/andrewmcclelland/Documents/spotify-track-explorer/ste-client/src/app/me/page.tsx"],"sourcesContent":["\"use client\";\nimport { useEffect, useState } from \"react\";\nimport { useRouter } from \"next/navigation\";\nimport { getJson } from \"@/lib/api\";\n\ntype Me = { username: string; roles: string[] };\n\nexport default function MePage() {\n  const router = useRouter();\n  const [me, setMe] = useState<Me | null>(null);\n  const [err, setErr] = useState<string | null>(null);\n\n  useEffect(() => {\n    const token =\n      typeof window !== \"undefined\"\n        ? localStorage.getItem(\"access_token\")\n        : null;\n    if (!token) {\n      console.debug(\"/me: no token in localStorage; redirecting\");\n      router.replace(\"/login\");\n      return;\n    }\n    console.debug(\"/me: found token; calling API\");\n    let mounted = true;\n    getJson<Me>(\"/api/me\")\n      .then((data) => {\n        if (mounted) setMe(data);\n      })\n      .catch((e: Error) => {\n        if (!mounted) return;\n        const msg = e.message || \"Failed to load\";\n        if (msg.startsWith(\"401\")) {\n          localStorage.removeItem(\"access_token\");\n          setErr(\"Not signed in\");\n          router.replace(\"/login\");\n        } else {\n          setErr(msg);\n        }\n      });\n    return () => {\n      mounted = false;\n    };\n  }, [router]);\n\n  if (err) return <div className=\"alert\">{err}</div>;\n  if (!me) return <div className=\"loading loading-spinner loading-md\" />;\n\n  return (\n    <div className=\"prose\">\n      <h1>Account</h1>\n      <p>\n        <b>User:</b> {me.username}\n      </p>\n      <p>\n        <b>Roles:</b> {me.roles && me.roles.length ? me.roles.join(\", \") : \"â€”\"}\n      </p>\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;AACA;AACA;AACA;;;AAHA;;;;AAOe,SAAS;;IACtB,MAAM,SAAS,IAAA,iRAAS;IACxB,MAAM,CAAC,IAAI,MAAM,GAAG,IAAA,wSAAQ,EAAY;IACxC,MAAM,CAAC,KAAK,OAAO,GAAG,IAAA,wSAAQ,EAAgB;IAE9C,IAAA,ySAAS;4BAAC;YACR,MAAM,QACJ,uCACI,aAAa,OAAO,CAAC,kBACrB;YACN,IAAI,CAAC,OAAO;gBACV,QAAQ,KAAK,CAAC;gBACd,OAAO,OAAO,CAAC;gBACf;YACF;YACA,QAAQ,KAAK,CAAC;YACd,IAAI,UAAU;YACd,IAAA,+HAAO,EAAK,WACT,IAAI;oCAAC,CAAC;oBACL,IAAI,SAAS,MAAM;gBACrB;mCACC,KAAK;oCAAC,CAAC;oBACN,IAAI,CAAC,SAAS;oBACd,MAAM,MAAM,EAAE,OAAO,IAAI;oBACzB,IAAI,IAAI,UAAU,CAAC,QAAQ;wBACzB,aAAa,UAAU,CAAC;wBACxB,OAAO;wBACP,OAAO,OAAO,CAAC;oBACjB,OAAO;wBACL,OAAO;oBACT;gBACF;;YACF;oCAAO;oBACL,UAAU;gBACZ;;QACF;2BAAG;QAAC;KAAO;IAEX,IAAI,KAAK,qBAAO,4TAAC;QAAI,WAAU;kBAAS;;;;;;IACxC,IAAI,CAAC,IAAI,qBAAO,4TAAC;QAAI,WAAU;;;;;;IAE/B,qBACE,4TAAC;QAAI,WAAU;;0BACb,4TAAC;0BAAG;;;;;;0BACJ,4TAAC;;kCACC,4TAAC;kCAAE;;;;;;oBAAS;oBAAE,GAAG,QAAQ;;;;;;;0BAE3B,4TAAC;;kCACC,4TAAC;kCAAE;;;;;;oBAAU;oBAAE,GAAG,KAAK,IAAI,GAAG,KAAK,CAAC,MAAM,GAAG,GAAG,KAAK,CAAC,IAAI,CAAC,QAAQ;;;;;;;;;;;;;AAI3E;GAnDwB;;QACP,iRAAS;;;KADF","debugId":null}}]
}